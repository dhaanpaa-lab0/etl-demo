# Contributing to ETL Demo

Thank you for your interest in contributing to this project! This document provides guidelines and instructions for
contributing.

## Code of Conduct

This project aims to be welcoming and inclusive. Please be respectful and constructive in all interactions.

## Getting Started

### Prerequisites

- Python 3.12 or higher
- Git
- A PostgreSQL, MySQL, or DuckDB instance (for testing database functionality)

### Development Setup

1. **Fork and clone the repository**
   ```bash
   git clone https://github.com/your-username/etl-demo.git
   cd etl-demo
   ```

2. **Create a virtual environment**
   ```bash
   uv venv
   source .venv/bin/activate  # On macOS/Linux
   # or
   .venv\Scripts\activate  # On Windows
   ```

3. **Install dependencies**
   ```bash
   uv pip install -e .
   ```

4. **Configure environment variables**
   ```bash
   cp .env.example .env
   # Edit .env with your database credentials
   ```

5. **Run database migrations**
   ```bash
   alembic upgrade head
   ```

6. **Verify the setup**
   ```bash
   python main.py
   ```

## How to Contribute

### Reporting Bugs

If you find a bug, please open an issue with:

- A clear, descriptive title
- Steps to reproduce the issue
- Expected behavior vs. actual behavior
- Your environment details (Python version, database type, OS)
- Relevant logs or error messages

### Suggesting Features

Feature suggestions are welcome! Please open an issue with:

- A clear description of the feature
- The problem it solves or use case it addresses
- Any implementation ideas you have

### Submitting Changes

1. **Create a new branch**
   ```bash
   git checkout -b feature/your-feature-name
   # or
   git checkout -b fix/your-bug-fix
   ```

2. **Make your changes**
    - Write clear, concise code
    - Follow the existing code style
    - Add comments for complex logic
    - Update documentation if needed

3. **Format your code**
   ```bash
   black .
   ```

4. **Test your changes**
    - Run the main demo: `python main.py`
    - Test with different database backends (PostgreSQL, MySQL, DuckDB)
    - Verify migrations work: `alembic upgrade head` and `alembic downgrade -1`

5. **Commit your changes**
   ```bash
   git add .
   git commit -m "Clear description of your changes"
   ```

6. **Push to your fork**
   ```bash
   git push origin feature/your-feature-name
   ```

7. **Open a Pull Request**
    - Provide a clear title and description
    - Reference any related issues
    - Explain what your changes do and why

## Code Style Guidelines

### Python Code

- **Formatting**: Use [Black](https://github.com/psf/black) for code formatting
    - Run `black .` before committing
    - Configuration is in `pyproject.toml`

- **Naming Conventions**:
    - Classes: `PascalCase` (e.g., `EtlDbConfig`)
    - Functions/methods: `snake_case` (e.g., `get_file_sources`)
    - Constants: `UPPER_SNAKE_CASE` (e.g., `DEFAULT_PORT`)
    - Private methods: prefix with `_` (e.g., `_build_uri`)

- **Type Hints**: Use type hints where they improve code clarity

- **Docstrings**: Add docstrings for public classes and methods

### Database Migrations

- **Creating Migrations**:
  ```bash
  alembic revision -m "descriptive message" --autogenerate
  ```

- **Migration Guidelines**:
    - Review autogenerated migrations before committing
    - Test both `upgrade` and `downgrade` paths
    - Keep migrations small and focused
    - Include appropriate indexes and constraints

- **Database Compatibility**:
    - Migrations are primarily designed for PostgreSQL
    - Consider compatibility with MySQL and DuckDB when possible
    - Document any database-specific behavior

### Environment Configuration

- **Never commit credentials**: Keep `.env` out of version control
- **Update `.env.example`**: Add new required variables to `.env.example`
- **Default values**: Use sensible defaults in code when possible
- **Named environments**: Support environment prefixes (e.g., `PG_DEV_*`)

## Project Architecture

When contributing, please maintain these architectural patterns:

1. **Environment-based configuration**: All database credentials from environment variables
2. **Named environments**: Support multiple configs via env name prefixes
3. **Folder management**: ETL jobs expect standard folder structure
4. **Alembic integration**: Migrations use the same config pattern as the application
5. **Engine factories**: Create engines via `EtlDbSource.get_engine()`

## Areas for Contribution

We welcome contributions in these areas:

- **Additional database backends**: Support for other databases (e.g., SQLite, Oracle)
- **Enhanced error handling**: Better error messages and recovery
- **Testing**: Unit tests and integration tests
- **Documentation**: Tutorials, examples, API documentation
- **Performance improvements**: Optimization and benchmarking
- **Features**: New ETL utilities and patterns

## Questions?

If you have questions about contributing, feel free to:

- Open an issue for discussion
- Ask in your pull request

## License

By contributing, you agree that your contributions will be licensed under the MIT License.
